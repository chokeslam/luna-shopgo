System.register(["@main"],(function(t,a){async function e(t){const a=t.dataset.id;if(!a)throw new Error("No product ID");const e=t.dataset.variantId;if(!e)throw new Error("No variant ID");const r=document.querySelector("[data-role=quantity]"),n=Number((null==r?void 0:r.value)||1),o=function(){const t=u.selectAll("[data-role=attachment]"),a={};for(const e of t){const t=e.querySelector("[data-role=attachment_id]"),r=e.querySelector("[data-role=attachment_quantity]");t.checked&&(a[t.value]=Number(r.value))}return a}();try{const t=await u.$http.post("@cart_ajax/addToCart",{product_id:a,variant_id:e,quantity:n,attachments:o});return function(t){u.trigger("cart.update",t);const a=t.length,e=document.querySelectorAll("[data-role=cart-button]");for(const t of e){const e=t.querySelector("[data-role=cart-quantity]");t.classList.toggle("h-has-items",a>0),e.textContent=a}}(t.data.data),t.data}catch(t){throw console.error(t),t}}function r(){location.href=u.route("cart")}return{setters:[function(t){}],execute:function(){u.delegate(document,"[data-task=add-to-cart]","click",(t=>{!async function(t){try{await e(t)}catch(t){return void u.alert(t.message,"","warning")}await swal({title:"已加入購物車",buttons:["繼續購物","前往結帳"]})&&r()}(t.target)})),u.delegate(document,"[data-task=buy]","click",(t=>{!async function(t){try{await e(t)}catch(t){return void u.alert(t.message,"","warning")}r()}(t.target)}))}}}));
//# sourceMappingURL=product-cart.js.map
