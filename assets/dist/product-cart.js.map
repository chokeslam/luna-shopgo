{"version":3,"file":"product-cart.js","names":["sendAddAction","el","productId","dataset","id","Error","hash","qtyInput","document","querySelector","res","u","$http","post","product_id","quantity","Number","value","data","addToCart","v","swal","title","buttons","toCartPage","buy","location","href","route","delegate","e","target"],"sources":["product-cart.js"],"sourcesContent":["/**\n * Part of shopgo project.\n *\n * @copyright  Copyright (C) 2023 __ORGANIZATION__.\n * @license    __LICENSE__\n */\n\nimport '@main';\n\nu.delegate(document, '[data-task=add-to-cart]', 'click', (e) => {\n  addToCart(e.target);\n});\n\nu.delegate(document, '[data-task=buy]', 'click', (e) => {\n  buy(e.target);\n});\n\nasync function sendAddAction(el) {\n  const productId = el.dataset.id;\n\n  if (!productId) {\n    throw new Error('No product ID');\n  }\n\n  const hash = el.dataset.hash;\n\n  if (!hash) {\n    throw new Error('No variant hash');\n  }\n\n  const qtyInput = document.querySelector('[data-role=quantity]');\n\n  const res = await u.$http.post(\n    '@cart_ajax/addToCart',\n    {\n      product_id: productId,\n      hash,\n      quantity: Number(qtyInput.value)\n    }\n  );\n\n  return res.data;\n}\n\nasync function addToCart(el) {\n  sendAddAction(el);\n\n  const v = await swal({\n    title: '已加入購物車',\n    buttons: [\n      '繼續購物',\n      '前往結帳'\n    ]\n  });\n\n  if (!v) {\n    return;\n  }\n\n  toCartPage();\n}\n\nfunction buy(el) {\n  sendAddAction(el);\n\n  toCartPage();\n}\n\nfunction toCartPage() {\n  location.href = u.route('cart');\n}\n"],"mappings":";;;EAiBA,eAAeA,aAAa,CAACC,EAAE,EAAE;IAC/B,MAAMC,SAAS,GAAGD,EAAE,CAACE,OAAO,CAACC,EAAE;IAE/B,IAAI,CAACF,SAAS,EAAE;MACd,MAAM,IAAIG,KAAK,CAAC,eAAe,CAAC;IAClC;IAEA,MAAMC,IAAI,GAAGL,EAAE,CAACE,OAAO,CAACG,IAAI;IAE5B,IAAI,CAACA,IAAI,EAAE;MACT,MAAM,IAAID,KAAK,CAAC,iBAAiB,CAAC;IACpC;IAEA,MAAME,QAAQ,GAAGC,QAAQ,CAACC,aAAa,CAAC,sBAAsB,CAAC;IAE/D,MAAMC,GAAG,GAAG,MAAMC,CAAC,CAACC,KAAK,CAACC,IAAI,CAC5B,sBAAsB,EACtB;MACEC,UAAU,EAAEZ,SAAS;MACrBI,IAAI;MACJS,QAAQ,EAAEC,MAAM,CAACT,QAAQ,CAACU,KAAK;IACjC,CAAC,CACF;IAED,OAAOP,GAAG,CAACQ,IAAI;EACjB;EAEA,eAAeC,SAAS,CAAClB,EAAE,EAAE;IAC3BD,aAAa,CAACC,EAAE,CAAC;IAEjB,MAAMmB,CAAC,GAAG,MAAMC,IAAI,CAAC;MACnBC,KAAK,EAAE,QAAQ;MACfC,OAAO,EAAE,CACP,MAAM,EACN,MAAM;IAEV,CAAC,CAAC;IAEF,IAAI,CAACH,CAAC,EAAE;MACN;IACF;IAEAI,UAAU,EAAE;EACd;EAEA,SAASC,GAAG,CAACxB,EAAE,EAAE;IACfD,aAAa,CAACC,EAAE,CAAC;IAEjBuB,UAAU,EAAE;EACd;EAEA,SAASA,UAAU,GAAG;IACpBE,QAAQ,CAACC,IAAI,GAAGhB,CAAC,CAACiB,KAAK,CAAC,MAAM,CAAC;EACjC;EAAC;IAAA;IAAA;MAtED;AACA;AACA;AACA;AACA;AACA;;MAIAjB,CAAC,CAACkB,QAAQ,CAACrB,QAAQ,EAAE,yBAAyB,EAAE,OAAO,EAAGsB,CAAC,IAAK;QAC9DX,SAAS,CAACW,CAAC,CAACC,MAAM,CAAC;MACrB,CAAC,CAAC;MAEFpB,CAAC,CAACkB,QAAQ,CAACrB,QAAQ,EAAE,iBAAiB,EAAE,OAAO,EAAGsB,CAAC,IAAK;QACtDL,GAAG,CAACK,CAAC,CAACC,MAAM,CAAC;MACf,CAAC,CAAC;IAAC;EAAA;AAAA"}