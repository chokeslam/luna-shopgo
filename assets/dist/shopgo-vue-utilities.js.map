{"version":3,"file":"shopgo-vue-utilities.js","names":["window","ShopgoVueUtilities","prepareVueItem","item","callback","arguments","length","undefined","uid","u","tid","prepareVueItemList","items","map","mergeRecursive","obj1","obj2","ignoreValues","p","includes","constructor","Object","e","ShopGoVuePlugin","app","config","compilerOptions","whitespace","isCustomElement","tag","globalProperties","$lang","id","_len","args","Array","_key","__","$numberFormat","num","prefix","negative","formatted","numberFormat","Math","abs","$offsetFormat","$priceOffset","method","$formatPrice","addCode","Currency","format","Colorpicker","mounted","el","_ref","value","$ui","colorPicker","Spectrum","getInstance","assign","updated","_ref2","sp","options","JSON","stringify","rebuild","unmounted","destroy","Tooltip","_ref3","inc","bootstrap","tooltip","_ref4","update","beforeUnmount","dispose","TomSelect","_ref5","setTimeout","tomSelect"],"sources":["shopgo-vue-utilities.js"],"sourcesContent":["/**\n * Part of shopgo project.\n *\n * @copyright  Copyright (C) 2023 __ORGANIZATION__.\n * @license    __LICENSE__\n */\n\nwindow.ShopgoVueUtilities = class ShopgoVueUtilities {\n  /**\n   * @template {[name: string]: any} T\n   * @param {T} item\n   * @param {(item: T) => T} callback\n   * @returns {object}\n   */\n  static prepareVueItem(item, callback = null) {\n    if (callback) {\n      item = callback(item) || item;\n    }\n\n    item.uid = item.uid || u.tid();\n\n    return item;\n  }\n\n  /**\n   * @template {[name: string]: any} T\n   * @param {T[]} items\n   * @param {(item: T) => T} callback\n   * @returns {object[]}\n   */\n  static prepareVueItemList(items, callback = null) {\n    return items.map((item) => this.prepareVueItem(item, callback));\n  }\n\n  /**\n   * Merge recursive but ignore some values, Based on ChatGPT, modified by Simon.\n   *\n   * @template {[name: string]: any} T\n   * @param {T} obj1\n   * @param {object} obj2\n   * @param {any[]} ignoreValues\n   * @returns {T}\n   */\n  static mergeRecursive(obj1, obj2, ignoreValues = [null, undefined, '']) {\n    for (let p in obj2) {\n      try {\n        if (ignoreValues.includes(obj2[p])) {\n          continue;\n        }\n\n        // Property in destination object set; update its value.\n        if (obj2[p].constructor === Object) {\n          obj1[p] = this.mergeRecursive(obj1[p], obj2[p]);\n        } else {\n          obj1[p] = obj2[p];\n        }\n      } catch (e) {\n        // Property in destination object not set; create it and set its value.\n        obj1[p] = obj2[p];\n      }\n    }\n    return obj1;\n  }\n};\n\nwindow.ShopGoVuePlugin = function (app) {\n  app.config.compilerOptions.whitespace = 'preserve';\n\n  app.config.compilerOptions.isCustomElement = (tag) => {\n    return [\n      'uni-flatpickr',\n      'uni-iframe-modal'\n    ].includes(tag);\n  };\n\n  app.config.globalProperties.$lang = (id, ...args) => {\n    return u.__(id, ...args);\n  };\n\n  app.config.globalProperties.$numberFormat = (num, prefix = '') => {\n    const negative = num < 0;\n    let formatted = prefix + u.numberFormat(Math.abs(num));\n\n    if (negative) {\n      formatted = '-' + formatted;\n    }\n\n    return formatted;\n  };\n\n  app.config.globalProperties.$offsetFormat = (num, prefix = '') => {\n    const negative = num < 0;\n    let formatted = prefix + u.numberFormat(Math.abs(num));\n\n    if (negative) {\n      formatted = '-' + formatted;\n    } else {\n      formatted = '+' + formatted;\n    }\n\n    return formatted;\n  };\n\n  app.config.globalProperties.$priceOffset = (num, method) => {\n    const negative = num < 0;\n\n    if (method === 'fixed') {\n      return '=' + u.numberFormat(Math.abs(num));\n    }\n\n    if (method === 'offsets') {\n      if (negative) {\n        return '-' + u.numberFormat(Math.abs(num));\n      }\n\n      return '+' + u.numberFormat(Math.abs(num));\n    }\n\n    if (method === 'percentage') {\n      if (num > 100) {\n        num = 100;\n      }\n\n      return num + '%';\n    }\n\n    return num;\n  };\n\n  app.config.globalProperties.$formatPrice = (num, addCode = false) => {\n    return Currency.format(num, addCode);\n  };\n};\n\n// Directive\n\n// Colorpicker\nwindow.ShopGoVuePlugin.Colorpicker = {\n  async mounted(el, { value }) {\n    await u.$ui.colorPicker();\n    Spectrum.getInstance(el, Object.assign({}, value));\n  },\n  updated(el, { value }) {\n    const sp = Spectrum.getInstance(el, options);\n\n    if (JSON.stringify(value) !== JSON.stringify(sp.options)) {\n      sp.rebuild(Object.assign({}, value));\n    }\n  },\n  unmounted(el) {\n    const sp = Spectrum.getInstance(el);\n    sp.destroy();\n  }\n};\n\n// Tooltip\nwindow.ShopGoVuePlugin.Tooltip = {\n  async mounted(el, { value }) {\n    const inc = u.$ui.bootstrap.tooltip(el, value);\n  },\n  updated(el, { value }) {\n    const inc = u.$ui.bootstrap.tooltip(el, value);\n\n    inc.update();\n  },\n  beforeUnmount(el) {\n    const inc = u.$ui.bootstrap.tooltip(el);\n\n    inc.dispose();\n  }\n};\n\n// Tooltip\nwindow.ShopGoVuePlugin.TomSelect = {\n  async mounted(el, { value }) {\n    setTimeout(() => {\n      const inc = u.$ui.tomSelect(el, value);\n    }, 0);\n  },\n  beforeUnmount(el) {\n    const inc = u.$ui.tomSelect(el, value);\n\n    inc.destroy();\n  }\n};\n"],"mappings":"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"}