{"version":3,"sources":["shopgo-vue-utilities.js"],"names":["System","register","_export","_context","setters","execute","window","ShopgoVueUtilities","static","item","callback","arguments","length","undefined","u","tid","items","map","this","prepareVueItem","obj1","obj2","p","includes","constructor","Object","mergeRecursive","prepareVueItemList","ShopGoVuePlugin","app","config","compilerOptions","whitespace","isCustomElement","tag","globalProperties","$lang","id","_len","args","Array","_key","ignoreValues","num","prefix","negative","formatted","numberFormat","Math","abs","$offsetFormat","method","$numberFormat","Colorpicker","async","el","_ref","value","Spectrum","getInstance","assign","updated","_ref2","options","JSON","stringify","sp","rebuild","unmounted","destroy","Tooltip","_ref3","$ui","bootstrap","tooltip","_ref4","update","beforeUnmount"],"mappings":"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","file":"shopgo-vue-utilities.js","sourcesContent":["/**\n * Part of shopgo project.\n *\n * @copyright  Copyright (C) 2023 __ORGANIZATION__.\n * @license    __LICENSE__\n */\n\nwindow.ShopgoVueUtilities = class ShopgoVueUtilities {\n  /**\n   * @template {[name: string]: any} T\n   * @param {T} item\n   * @param {(item: T) => T} callback\n   * @returns {object}\n   */\n  static prepareVueItem(item, callback = null) {\n    if (callback) {\n      item = callback(item) || item;\n    }\n\n    item.uid = item.uid || u.tid();\n\n    return item;\n  }\n\n  /**\n   * @template {[name: string]: any} T\n   * @param {T[]} items\n   * @param {(item: T) => T} callback\n   * @returns {object[]}\n   */\n  static prepareVueItemList(items, callback = null) {\n    return items.map((item) => this.prepareVueItem(item, callback));\n  }\n\n  /**\n   * Merge recursive but ignore some values, Based on ChatGPT, modified by Simon.\n   *\n   * @template {[name: string]: any} T\n   * @param {T} obj1\n   * @param {object} obj2\n   * @param {any[]} ignoreValues\n   * @returns {T}\n   */\n  static mergeRecursive(obj1, obj2, ignoreValues = [null, undefined, '']) {\n    for (let p in obj2) {\n      try {\n        if (ignoreValues.includes(obj2[p])) {\n          continue;\n        }\n\n        // Property in destination object set; update its value.\n        if (obj2[p].constructor === Object) {\n          obj1[p] = this.mergeRecursive(obj1[p], obj2[p]);\n        } else {\n          obj1[p] = obj2[p];\n        }\n      } catch (e) {\n        // Property in destination object not set; create it and set its value.\n        obj1[p] = obj2[p];\n      }\n    }\n    return obj1;\n  }\n};\n\nwindow.ShopGoVuePlugin = function (app) {\n  app.config.compilerOptions.whitespace = 'preserve';\n\n  app.config.compilerOptions.isCustomElement = (tag) => {\n    return [\n      'uni-flatpickr'\n    ].includes(tag);\n  };\n\n  app.config.globalProperties.$lang = (id, ...args) => {\n    return u.__(id, ...args);\n  };\n\n  app.config.globalProperties.$numberFormat = (num, prefix = '') => {\n    const negative = num < 0;\n    let formatted = prefix + u.numberFormat(Math.abs(num));\n\n    if (negative) {\n      formatted = '-' + formatted;\n    }\n\n    return formatted;\n  };\n\n  app.config.globalProperties.$offsetFormat = (num, prefix = '') => {\n    const negative = num < 0;\n    let formatted = prefix + u.numberFormat(Math.abs(num));\n\n    if (negative) {\n      formatted = '-' + formatted;\n    } else {\n      formatted = '+' + formatted;\n    }\n\n    return formatted;\n  };\n\n  app.config.globalProperties.$priceOffset = (num, method) => {\n    const negative = num < 0;\n\n    if (method === 'fixed') {\n      return '=' + u.numberFormat(Math.abs(num));\n    }\n\n    if (method === 'offsets') {\n      if (negative) {\n        return '-' + u.numberFormat(Math.abs(num));\n      }\n\n      return '+' + u.numberFormat(Math.abs(num));\n    }\n\n    if (method === 'percentage') {\n      if (num > 100) {\n        num = 100;\n      }\n\n      return num + '%';\n    }\n\n    return num;\n  };\n};\n\n// Directive\n\n// Colorpicker\nwindow.ShopGoVuePlugin.Colorpicker = {\n  async mounted(el, { value }) {\n    await u.$ui.colorPicker();\n    Spectrum.getInstance(el, Object.assign({}, value));\n  },\n  updated(el, { value }) {\n    const sp = Spectrum.getInstance(el, options);\n\n    if (JSON.stringify(value) !== JSON.stringify(sp.options)) {\n      sp.rebuild(Object.assign({}, value));\n    }\n  },\n  unmounted(el) {\n    const sp = Spectrum.getInstance(el);\n    sp.destroy();\n  }\n};\n\n// Tooltip\nwindow.ShopGoVuePlugin.Tooltip = {\n  async mounted(el, { value }) {\n    const inc = u.$ui.bootstrap.tooltip(el, value);\n  },\n  updated(el, { value }) {\n    const inc = u.$ui.bootstrap.tooltip(el, value);\n\n    inc.update();\n  },\n  beforeUnmount(el) {\n    const inc = u.$ui.bootstrap.tooltip(el, value);\n\n    inc.dispose();\n  }\n};\n"]}