{"version":3,"sources":["shopgo-vue-utilities.js"],"names":["System","register","_export","_context","setters","execute","window","ShopgoVueUtilities","static","item","callback","arguments","length","undefined","u","tid","items","map","this","prepareVueItem","obj1","obj2","p","includes","constructor","Object","mergeRecursive","prepareVueItemList","ShopGoVuePlugin","app","config","compilerOptions","whitespace","isCustomElement","tag","globalProperties","$lang","id","_len","args","Array","_key","ignoreValues","num","negative","formatted","numberFormat","Math","abs","$offsetFormat","method","$numberFormat","prefix","addCode","Currency","Colorpicker","async","el","_ref","value","$ui","colorPicker","Spectrum","getInstance","assign","updated","_ref2","sp","options","JSON","stringify","rebuild","unmounted","destroy","format","_ref3","bootstrap","tooltip","_ref4","beforeUnmount","TomSelect","_ref5","tomSelect"],"mappings":"AAAAA,OAAOC,SAAS,IAAI,SAAUC,EAASC,GAGrC,MAAO,CACLC,QAAS,GACTC,QAAS,WAJbC,OAAAC,mBAAA,MACAC,sBAAAC,GACA,IAAAC,EAAAC,UAAAC,OAAA,QAAAC,IAAAF,UAAA,GAAAA,UAAA,GAAA,KAKE,OAJFD,IACAD,EAAAC,EAAAD,IAAAA,GAEAH,EAAOC,IAAAA,EAAAA,KAAkBO,EAAGC,MAC1BN,CACF,CAEAD,0BAAAQ,GACA,IAAAN,EAAAC,UAAAC,OAAA,QAAAC,IAAAF,UAAA,GAAAA,UAAA,GAAA,KACA,OAAAK,EAAAC,KAAAR,GAAAS,KAAAC,eAAAV,EAAAC,IACE,CAQMF,sBAPUY,EAAAC,GAQR,IAPJZ,EAAgBA,UAASA,OAAI,QAAAI,IAAAF,UAAA,GAAAA,UAAA,GAAA,CAAA,UAAAE,EAAA,IAC/B,IAAA,IAAAS,KAAAD,EAEAZ,IAEA,GAAOA,EAAIc,SAAAF,EAAAC,IACb,SAGFD,EAAAC,GAAAE,cAAAC,OACAL,EAAAE,GAAAJ,KAAAQ,eAAAN,EAAAE,GAAAD,EAAAC,IAEAF,EAAAE,GAAAD,EAAAC,EAEE,CAAA,MAAOK,GAA0BjB,EAAAA,GAAQW,EAAAV,EACvC,CAQM,OAAOS,CALf,GAEFd,OAAAsB,gBAAA,SAAAC,GACAA,EAAAC,OAAAC,gBAAAC,WAAA,WACAH,EAAAC,OAAAC,gBAAAE,gBAAAC,GACA,CAAA,gBAAA,oBAAAX,SAAAW,GAEAL,EAAAC,OAAAK,iBAAAC,MAAA,SAAAC,GACA,IAAA,IAAAC,EAAA3B,UAAAC,OAAA2B,EAAA,IAAAC,MAAAF,EAAA,EAAAA,EAAA,EAAA,GAAAG,EAAA,EAAAA,EAAAH,EAAAG,IACEF,EAAOb,EAAAA,GAAcA,UAAOL,GAC1B,OAAKP,EAAIQ,GAACe,KAAQE,EAQd,EACAV,EAAIC,OAPAY,iBAAanB,cAAmB,SAAAoB,GASlC,MAPFC,EAAAD,EAAA,EAQE,IAAIE,GATJlC,UAAAC,OAAA,QAAAC,IAAAF,UAAA,GAAAA,UAAA,GAAA,IASyBG,EAAEgC,aAAaC,KAAKC,IAAIL,IAIjD,OAVFC,IAQIC,EAPM,IAAErB,GAEXqB,CAQD,EACAhB,EAAIC,OAPJK,iBAAAc,cAAA,SAAAN,GASE,MAPFC,EAAAD,EAAA,EAQE,IAPFvB,GAFQT,UAAEC,OAAA,QAAAC,IAAAF,UAAA,GAAAA,UAAA,GAAA,IAEOG,EAAAgC,aAAAC,KAAAC,IAAAL,IAOzBrC,OALIuC,EADED,EACF,IAAAC,EAEF,IAAAA,EAGKjB,CACLC,EAEAA,EAAIC,OAAOC,iBAAgBE,aAAe,CAAAU,EAAOO,KAC/C,MAAAN,EACED,EAAe,EAGlB,MAAA,UAAAO,EAEUf,IAAAA,EAAAA,aAAiBC,KAAQY,IAAAL,IAAY,YAAJJ,EAAIK,EACnC,IAAK9B,EAAGyB,aAAKQ,KAAAC,IAAAL,IAGfR,IAAAA,EAAAA,aAAiBgB,KAAAA,IAAaR,IACzB,eAAdO,GACIL,EAAAA,MAEAD,EAAAA,KAEJD,EAAA,KAGDA,CAAA,EAIKd,EAF4DC,OAAhBsB,iBAAMxC,aAAAD,SAAAgC,GACtD,IAAAU,EAAc1C,UAAUC,OAAA,QAAAC,IAAAF,UAAA,IAAAA,UAAA,GACxB,OAAIkC,SAAYO,OAAMT,OAAKG,EAAYO,EAGnC,EACAxB,EADFgB,OAAAA,iBAAkBA,UAASS,QAE3B,EAGAhD,OAAFsB,gBAAgB2B,YAAA,CAClBC,cAACC,EAAAC,GAED7B,IAAIC,MACF6B,GAEIT,QACFpC,EAAA8C,IAAUC,cACZC,SAAAC,YAAAN,EAAAhC,OAAAuC,OAAA,CAAA,EAAAL,GADI,EACAM,QAGErB,EAAAA,GAFA,IAGFe,MACFA,GAEAO,EACF,MAAAC,EAAAL,SAAAC,YAAAN,EAAAW,SAEIlB,KAAAA,UAAWS,KAAcU,KAAAC,UAAAH,EAAAC,UAC3BD,EAAAI,QAAU9C,OAAKuC,OAAA,CAAA,EAAAL,GAHb,EACAa,UAMFf,GACFK,SAAAC,YAAAN,GAEAgB,SACF,GAJInE,OAOFsB,gBAAgB8C,QAAY7D,CAC9B2C,cAACC,EAAAkB,GAED9C,IAAIC,MACL6B,GAPagB,EASd7D,EAAA8C,IAAAgB,UAAAC,QAAApB,EAAAE,EAPQ,EASRM,QAAAR,EAAAqB,GACAxE,IAAOsB,MACL+B,GAAkBmB,EAAEnB,EAAAA,IAAAA,UAAAA,QAAAA,EAAAA,GAAOD,QAJrB,EACAqB,cAKKhB,GACVjD,EAAA8C,IAAAgB,UAAAC,QAAApB,GACDQ,SAJM,GAGF3D,OAEFsB,gBAAmBoD,UAAY,CAD3BxB,cAGKc,EAAAA,GAFH,IAGFX,MACJA,GACDsB,EACDT,YAAY,KACCV,EAAAA,IAASC,UAAAA,EAAcJ,EAAC,GAChCc,EACL,EACDM,cAAAtB,GAFqB3C,EAAE8C,IAAIsB,UAAUzB,EAAIE,OAI1Cc,SACAnE,EADI,EAEJ","file":"shopgo-vue-utilities.js","sourcesContent":["/**\n * Part of shopgo project.\n *\n * @copyright  Copyright (C) 2023 __ORGANIZATION__.\n * @license    __LICENSE__\n */\n\nwindow.ShopgoVueUtilities = class ShopgoVueUtilities {\n  /**\n   * @template {[name: string]: any} T\n   * @param {T} item\n   * @param {(item: T) => T} callback\n   * @returns {object}\n   */\n  static prepareVueItem(item, callback = null) {\n    if (callback) {\n      item = callback(item) || item;\n    }\n\n    item.uid = item.uid || u.tid();\n\n    return item;\n  }\n\n  /**\n   * @template {[name: string]: any} T\n   * @param {T[]} items\n   * @param {(item: T) => T} callback\n   * @returns {object[]}\n   */\n  static prepareVueItemList(items, callback = null) {\n    return items.map((item) => this.prepareVueItem(item, callback));\n  }\n\n  /**\n   * Merge recursive but ignore some values, Based on ChatGPT, modified by Simon.\n   *\n   * @template {[name: string]: any} T\n   * @param {T} obj1\n   * @param {object} obj2\n   * @param {any[]} ignoreValues\n   * @returns {T}\n   */\n  static mergeRecursive(obj1, obj2, ignoreValues = [null, undefined, '']) {\n    for (let p in obj2) {\n      try {\n        if (ignoreValues.includes(obj2[p])) {\n          continue;\n        }\n\n        // Property in destination object set; update its value.\n        if (obj2[p].constructor === Object) {\n          obj1[p] = this.mergeRecursive(obj1[p], obj2[p]);\n        } else {\n          obj1[p] = obj2[p];\n        }\n      } catch (e) {\n        // Property in destination object not set; create it and set its value.\n        obj1[p] = obj2[p];\n      }\n    }\n    return obj1;\n  }\n};\n\nwindow.ShopGoVuePlugin = function (app) {\n  app.config.compilerOptions.whitespace = 'preserve';\n\n  app.config.compilerOptions.isCustomElement = (tag) => {\n    return [\n      'uni-flatpickr',\n      'uni-iframe-modal'\n    ].includes(tag);\n  };\n\n  app.config.globalProperties.$lang = (id, ...args) => {\n    return u.__(id, ...args);\n  };\n\n  app.config.globalProperties.$numberFormat = (num, prefix = '') => {\n    const negative = num < 0;\n    let formatted = prefix + u.numberFormat(Math.abs(num));\n\n    if (negative) {\n      formatted = '-' + formatted;\n    }\n\n    return formatted;\n  };\n\n  app.config.globalProperties.$offsetFormat = (num, prefix = '') => {\n    const negative = num < 0;\n    let formatted = prefix + u.numberFormat(Math.abs(num));\n\n    if (negative) {\n      formatted = '-' + formatted;\n    } else {\n      formatted = '+' + formatted;\n    }\n\n    return formatted;\n  };\n\n  app.config.globalProperties.$priceOffset = (num, method) => {\n    const negative = num < 0;\n\n    if (method === 'fixed') {\n      return '=' + u.numberFormat(Math.abs(num));\n    }\n\n    if (method === 'offsets') {\n      if (negative) {\n        return '-' + u.numberFormat(Math.abs(num));\n      }\n\n      return '+' + u.numberFormat(Math.abs(num));\n    }\n\n    if (method === 'percentage') {\n      if (num > 100) {\n        num = 100;\n      }\n\n      return num + '%';\n    }\n\n    return num;\n  };\n\n  app.config.globalProperties.$formatPrice = (num, addCode = false) => {\n    return Currency.format(num, undefined, addCode);\n  };\n\n  app.config.globalProperties.$currency = Currency;\n};\n\n// Directive\n\n// Colorpicker\nwindow.ShopGoVuePlugin.Colorpicker = {\n  async mounted(el, { value }) {\n    await u.$ui.colorPicker();\n    Spectrum.getInstance(el, Object.assign({}, value));\n  },\n  updated(el, { value }) {\n    const sp = Spectrum.getInstance(el, options);\n\n    if (JSON.stringify(value) !== JSON.stringify(sp.options)) {\n      sp.rebuild(Object.assign({}, value));\n    }\n  },\n  unmounted(el) {\n    const sp = Spectrum.getInstance(el);\n    sp.destroy();\n  }\n};\n\n// Tooltip\nwindow.ShopGoVuePlugin.Tooltip = {\n  async mounted(el, { value }) {\n    const inc = u.$ui.bootstrap.tooltip(el, value);\n  },\n  updated(el, { value }) {\n    const inc = u.$ui.bootstrap.tooltip(el, value);\n\n    inc.update();\n  },\n  beforeUnmount(el) {\n    const inc = u.$ui.bootstrap.tooltip(el);\n\n    inc.dispose();\n  }\n};\n\n// Tooltip\nwindow.ShopGoVuePlugin.TomSelect = {\n  async mounted(el, { value }) {\n    setTimeout(() => {\n      const inc = u.$ui.tomSelect(el, value);\n    }, 0);\n  },\n  beforeUnmount(el) {\n    const inc = u.$ui.tomSelect(el, value);\n\n    inc.destroy();\n  }\n};\n"]}