{"version":3,"file":"shopgo-vue-utilities.js","names":["window","ShopgoVueUtilities","prepareVueItem","item","callback","uid","u","tid","prepareVueItemList","items","map","mergeRecursive","obj1","obj2","ignoreValues","undefined","p","includes","constructor","Object","e","ShopGoVuePlugin","app","config","compilerOptions","whitespace","isCustomElement","tag","globalProperties","$lang","id","args","__","$numberFormat","num","prefix","negative","formatted","numberFormat","Math","abs","$offsetFormat","$priceOffset","method","$formatPrice","addCode","Currency","format","Colorpicker","mounted","el","value","$ui","colorPicker","Spectrum","getInstance","assign","updated","sp","options","JSON","stringify","rebuild","unmounted","destroy","Tooltip","inc","bootstrap","tooltip","update","beforeUnmount","dispose","TomSelect","tomSelect"],"sources":["shopgo-vue-utilities.js"],"sourcesContent":["/**\n * Part of shopgo project.\n *\n * @copyright  Copyright (C) 2023 __ORGANIZATION__.\n * @license    __LICENSE__\n */\n\nwindow.ShopgoVueUtilities = class ShopgoVueUtilities {\n  /**\n   * @template {[name: string]: any} T\n   * @param {T} item\n   * @param {(item: T) => T} callback\n   * @returns {object}\n   */\n  static prepareVueItem(item, callback = null) {\n    if (callback) {\n      item = callback(item) || item;\n    }\n\n    item.uid = item.uid || u.tid();\n\n    return item;\n  }\n\n  /**\n   * @template {[name: string]: any} T\n   * @param {T[]} items\n   * @param {(item: T) => T} callback\n   * @returns {object[]}\n   */\n  static prepareVueItemList(items, callback = null) {\n    return items.map((item) => this.prepareVueItem(item, callback));\n  }\n\n  /**\n   * Merge recursive but ignore some values, Based on ChatGPT, modified by Simon.\n   *\n   * @template {[name: string]: any} T\n   * @param {T} obj1\n   * @param {object} obj2\n   * @param {any[]} ignoreValues\n   * @returns {T}\n   */\n  static mergeRecursive(obj1, obj2, ignoreValues = [null, undefined, '']) {\n    for (let p in obj2) {\n      try {\n        if (ignoreValues.includes(obj2[p])) {\n          continue;\n        }\n\n        // Property in destination object set; update its value.\n        if (obj2[p].constructor === Object) {\n          obj1[p] = this.mergeRecursive(obj1[p], obj2[p]);\n        } else {\n          obj1[p] = obj2[p];\n        }\n      } catch (e) {\n        // Property in destination object not set; create it and set its value.\n        obj1[p] = obj2[p];\n      }\n    }\n    return obj1;\n  }\n};\n\nwindow.ShopGoVuePlugin = function (app) {\n  app.config.compilerOptions.whitespace = 'preserve';\n\n  app.config.compilerOptions.isCustomElement = (tag) => {\n    return [\n      'uni-flatpickr',\n      'uni-iframe-modal'\n    ].includes(tag);\n  };\n\n  app.config.globalProperties.$lang = (id, ...args) => {\n    return u.__(id, ...args);\n  };\n\n  app.config.globalProperties.$numberFormat = (num, prefix = '') => {\n    const negative = num < 0;\n    let formatted = prefix + u.numberFormat(Math.abs(num));\n\n    if (negative) {\n      formatted = '-' + formatted;\n    }\n\n    return formatted;\n  };\n\n  app.config.globalProperties.$offsetFormat = (num, prefix = '') => {\n    const negative = num < 0;\n    let formatted = prefix + u.numberFormat(Math.abs(num));\n\n    if (negative) {\n      formatted = '-' + formatted;\n    } else {\n      formatted = '+' + formatted;\n    }\n\n    return formatted;\n  };\n\n  app.config.globalProperties.$priceOffset = (num, method) => {\n    const negative = num < 0;\n\n    if (method === 'fixed') {\n      return '=' + u.numberFormat(Math.abs(num));\n    }\n\n    if (method === 'offsets') {\n      if (negative) {\n        return '-' + u.numberFormat(Math.abs(num));\n      }\n\n      return '+' + u.numberFormat(Math.abs(num));\n    }\n\n    if (method === 'percentage') {\n      if (num > 100) {\n        num = 100;\n      }\n\n      return num + '%';\n    }\n\n    return num;\n  };\n\n  app.config.globalProperties.$formatPrice = (num, addCode = false) => {\n    return Currency.format(num, addCode);\n  };\n};\n\n// Directive\n\n// Colorpicker\nwindow.ShopGoVuePlugin.Colorpicker = {\n  async mounted(el, { value }) {\n    await u.$ui.colorPicker();\n    Spectrum.getInstance(el, Object.assign({}, value));\n  },\n  updated(el, { value }) {\n    const sp = Spectrum.getInstance(el, options);\n\n    if (JSON.stringify(value) !== JSON.stringify(sp.options)) {\n      sp.rebuild(Object.assign({}, value));\n    }\n  },\n  unmounted(el) {\n    const sp = Spectrum.getInstance(el);\n    sp.destroy();\n  }\n};\n\n// Tooltip\nwindow.ShopGoVuePlugin.Tooltip = {\n  async mounted(el, { value }) {\n    const inc = u.$ui.bootstrap.tooltip(el, value);\n  },\n  updated(el, { value }) {\n    const inc = u.$ui.bootstrap.tooltip(el, value);\n\n    inc.update();\n  },\n  beforeUnmount(el) {\n    const inc = u.$ui.bootstrap.tooltip(el, value);\n\n    inc.dispose();\n  }\n};\n\n// Tooltip\nwindow.ShopGoVuePlugin.TomSelect = {\n  async mounted(el, { value }) {\n    const inc = u.$ui.tomSelect(el, value);\n  },\n  beforeUnmount(el) {\n    const inc = u.$ui.tomSelect(el, value);\n\n    inc.destroy();\n  }\n};\n"],"mappings":"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"}