{"version":3,"file":"wishlist-button.js","names":["WishlistButton","constructor","el","icon","querySelector","added","dataset","type","id","addEventListener","toggleFavorite","refreshStyle","task","res","u","$http","post","notify","data","message","e","console","error","alert","setAttribute","iconActive","iconInactive","directive","mounted","log","setTimeout","module"],"sources":["wishlist-button.js"],"sourcesContent":["/**\n * Part of shopgo project.\n *\n * @copyright  Copyright (C) 2023 __ORGANIZATION__.\n * @license    __LICENSE__\n */\n\nimport '@main';\n\nclass WishlistButton {\n  constructor(el) {\n    this.el = el;\n    this.icon = el.querySelector('i, span');\n    this.added = el.dataset.added === '1' || el.dataset.added === 'true';\n    this.type = el.dataset.type;\n    this.id = el.dataset.id;\n\n    this.el.addEventListener('click', async () => {\n      await this.toggleFavorite();\n      this.refreshStyle();\n    });\n\n    this.refreshStyle();\n  }\n\n  async toggleFavorite() {\n    const task = this.added ? 'removeWishlist' : 'addWishlist';\n\n    try {\n      const res = await u.$http.post(\n        `@wishlist_ajax/${task}`,\n        {\n          id: this.id,\n        }\n      );\n\n      u.notify(res.data.message);\n\n      this.added = !this.added;\n      this.el.dataset.added = this.added ? '1' : '0';\n    } catch (e) {\n      console.error(e);\n      u.alert(e.message, '', 'warning');\n    }\n  }\n\n  refreshStyle() {\n    if (this.added) {\n      this.icon.setAttribute('class', this.el.dataset.iconActive);\n    } else {\n      this.icon.setAttribute('class', this.el.dataset.iconInactive);\n    }\n  }\n}\n\nu.directive(\n  'wishlist-button',\n  {\n    mounted(el) {\n      console.log(el);\n      \n      setTimeout(() => {\n        u.module(el, 'wishlist.button', () => new WishlistButton(el));\n      }, 100);\n    }\n  }\n);\n"],"mappings":";;;MASMA,cAAc;EAAA;IAAA;IAAA;MATpB;AACA;AACA;AACA;AACA;AACA;MAIMA,cAAc,GAApB,MAAMA,cAAc,CAAC;QACnBC,WAAW,CAACC,EAAE,EAAE;UACd,IAAI,CAACA,EAAE,GAAGA,EAAE;UACZ,IAAI,CAACC,IAAI,GAAGD,EAAE,CAACE,aAAa,CAAC,SAAS,CAAC;UACvC,IAAI,CAACC,KAAK,GAAGH,EAAE,CAACI,OAAO,CAACD,KAAK,KAAK,GAAG,IAAIH,EAAE,CAACI,OAAO,CAACD,KAAK,KAAK,MAAM;UACpE,IAAI,CAACE,IAAI,GAAGL,EAAE,CAACI,OAAO,CAACC,IAAI;UAC3B,IAAI,CAACC,EAAE,GAAGN,EAAE,CAACI,OAAO,CAACE,EAAE;UAEvB,IAAI,CAACN,EAAE,CAACO,gBAAgB,CAAC,OAAO,EAAE,YAAY;YAC5C,MAAM,IAAI,CAACC,cAAc,EAAE;YAC3B,IAAI,CAACC,YAAY,EAAE;UACrB,CAAC,CAAC;UAEF,IAAI,CAACA,YAAY,EAAE;QACrB;QAEA,MAAMD,cAAc,GAAG;UACrB,MAAME,IAAI,GAAG,IAAI,CAACP,KAAK,GAAG,gBAAgB,GAAG,aAAa;UAE1D,IAAI;YACF,MAAMQ,GAAG,GAAG,MAAMC,CAAC,CAACC,KAAK,CAACC,IAAI,CAC3B,kBAAiBJ,IAAK,EAAC,EACxB;cACEJ,EAAE,EAAE,IAAI,CAACA;YACX,CAAC,CACF;YAEDM,CAAC,CAACG,MAAM,CAACJ,GAAG,CAACK,IAAI,CAACC,OAAO,CAAC;YAE1B,IAAI,CAACd,KAAK,GAAG,CAAC,IAAI,CAACA,KAAK;YACxB,IAAI,CAACH,EAAE,CAACI,OAAO,CAACD,KAAK,GAAG,IAAI,CAACA,KAAK,GAAG,GAAG,GAAG,GAAG;UAChD,CAAC,CAAC,OAAOe,CAAC,EAAE;YACVC,OAAO,CAACC,KAAK,CAACF,CAAC,CAAC;YAChBN,CAAC,CAACS,KAAK,CAACH,CAAC,CAACD,OAAO,EAAE,EAAE,EAAE,SAAS,CAAC;UACnC;QACF;QAEAR,YAAY,GAAG;UACb,IAAI,IAAI,CAACN,KAAK,EAAE;YACd,IAAI,CAACF,IAAI,CAACqB,YAAY,CAAC,OAAO,EAAE,IAAI,CAACtB,EAAE,CAACI,OAAO,CAACmB,UAAU,CAAC;UAC7D,CAAC,MAAM;YACL,IAAI,CAACtB,IAAI,CAACqB,YAAY,CAAC,OAAO,EAAE,IAAI,CAACtB,EAAE,CAACI,OAAO,CAACoB,YAAY,CAAC;UAC/D;QACF;MACF,CAAC;MAEDZ,CAAC,CAACa,SAAS,CACT,iBAAiB,EACjB;QACEC,OAAO,CAAC1B,EAAE,EAAE;UACVmB,OAAO,CAACQ,GAAG,CAAC3B,EAAE,CAAC;UAEf4B,UAAU,CAAC,MAAM;YACfhB,CAAC,CAACiB,MAAM,CAAC7B,EAAE,EAAE,iBAAiB,EAAE,MAAM,IAAIF,cAAc,CAACE,EAAE,CAAC,CAAC;UAC/D,CAAC,EAAE,GAAG,CAAC;QACT;MACF,CAAC,CACF;IAAC;EAAA;AAAA"}