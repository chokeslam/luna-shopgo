{"version":3,"sources":["wishlist-button.js"],"names":["System","register","_export","_context","WishlistButton","setters","_main","execute","constructor","el","this","icon","querySelector","added","dataset","type","async","toggleFavorite","task","res","u","$http","post","id","refreshStyle","message","console","error","alert","e","iconActive","setAttribute","iconInactive","directive","mounted","setTimeout","module"],"mappings":"AAAAA,OAAOC,SAAS,CAAC,UAAU,SAAUC,EAASC,GAG5C,IAMIC,EAAc,MAAA,CAAAC,QAAA,CAAA,SAAAC,GAAA,GAAAC,QAAA,WATpBH,EAAA,MACAI,YAAAC,GACAC,KAAAD,GAAAA,EACAC,KAAAC,KAAAF,EAAAG,cAAA,WACAF,KAAAG,MAAA,MAAAJ,EAAAK,QAAAD,OAAA,SAAAJ,EAAAK,QAAAD,MACAH,KAAAK,KAAAN,EAAAK,QAAAC,KAIMX,KAAAA,GAAcK,EAApBK,QAAMV,GACJI,KAAAA,GAAAA,iBAAgB,SAAAQ,gBACPN,KAAKO,iBACZP,KAAKC,cAAUC,IAEfF,KAAKK,cAKD,CACAC,uBACE,MAHJE,EAAWD,KAAAA,MAAAA,iBAAgB,cAIvB,IAFJ,MAAAE,QAAAC,EAAAC,MAAAC,KAAA,kBAAAJ,IAAA,CAEEK,GAACC,KAAAA,KAGPJ,EAAMH,OAAAA,EAAAA,KAAcQ,SAClBf,KAAMQ,OAAOR,KAAKG,MAElBH,KAAID,GAAAK,QAAAD,MAAAH,KAAAG,MAAA,IAAA,GAIE,CAHJ,MAAMM,GACAO,QAEEC,MAAKJ,GACXH,EACDQ,MAAAC,EAAAJ,QAAA,GAAA,UAFG,CACF,CACAD,eAMFd,KAAOmB,MACPH,KAAAA,KAAQC,aAAQ,QAAAjB,KAAAD,GAAAK,QAAAgB,YAElBpB,KAAAC,KAAAoB,aAAA,QAAArB,KAAAD,GAAAK,QAAAkB,aAGFR,GAJIJ,EAAEa,UAMGtB,kBAAkB,CALrBuB,QAMHzB,GALKiB,QAMCf,IAAKoB,GACZI,YAAA,KACFf,EAAAgB,OAAA3B,EAAA,mBAAA,IAAA,IAAAL,EAAAK,IAAA,GACD,IAECwB,GALE,EAEJ","file":"wishlist-button.js","sourcesContent":["/**\n * Part of shopgo project.\n *\n * @copyright  Copyright (C) 2023 __ORGANIZATION__.\n * @license    __LICENSE__\n */\n\nimport '@main';\n\nclass WishlistButton {\n  constructor(el) {\n    this.el = el;\n    this.icon = el.querySelector('i, span');\n    this.added = el.dataset.added === '1' || el.dataset.added === 'true';\n    this.type = el.dataset.type;\n    this.id = el.dataset.id;\n\n    this.el.addEventListener('click', async () => {\n      await this.toggleFavorite();\n      this.refreshStyle();\n    });\n\n    this.refreshStyle();\n  }\n\n  async toggleFavorite() {\n    const task = this.added ? 'removeWishlist' : 'addWishlist';\n\n    try {\n      const res = await u.$http.post(\n        `@wishlist_ajax/${task}`,\n        {\n          id: this.id,\n        }\n      );\n\n      u.notify(res.data.message);\n\n      this.added = !this.added;\n      this.el.dataset.added = this.added ? '1' : '0';\n    } catch (e) {\n      console.error(e);\n      u.alert(e.message, '', 'warning');\n    }\n  }\n\n  refreshStyle() {\n    if (this.added) {\n      this.icon.setAttribute('class', this.el.dataset.iconActive);\n    } else {\n      this.icon.setAttribute('class', this.el.dataset.iconInactive);\n    }\n  }\n}\n\nu.directive(\n  'wishlist-button',\n  {\n    mounted(el) {\n      console.log(el);\n      \n      setTimeout(() => {\n        u.module(el, 'wishlist.button', () => new WishlistButton(el));\n      }, 100);\n    }\n  }\n);\n"]}